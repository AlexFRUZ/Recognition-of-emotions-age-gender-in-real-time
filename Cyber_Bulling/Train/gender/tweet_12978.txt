The problem is not the joke, it's the context. When David Brent says "I think there's been a rape up there" we laugh at him for being pathetic, not at rape. When Mark and Jez discuss gay sex in Peep Show, we don't laugh at gay people, but at Mark's discomfort of the conversation.